<div class="v-card" data-id="{{ item.id }}" data-type="media">
    <div class="v-card-selection-overlay">âœ“</div>
    <a href="{% url 'media-detail-page' item.id %}" class="v-card-thumb">
        <!-- Status Overlays -->
        <div class="v-card-badge-container">
            {% if item.is_private %}<div class="v-badge"><i class="fas fa-lock"
                    style="font-size: 10px; margin-right: 4px;"></i> Private</div>{% endif %}
            {% if item.is_hidden %}<div class="v-badge"><i class="fas fa-eye-slash"
                    style="font-size: 10px; margin-right: 4px;"></i> Hidden</div>{% endif %}
        </div>

        {% if item.media_type == 'IMAGE' and item.file %}
        <img src="{{ item.file.url }}" alt="{{ item.title }}" class="v-card-img">
        {% elif item.thumbnail %}
        <img src="{{ item.thumbnail.url }}" alt="{{ item.title }}" class="v-card-img">
        {% else %}
        <div class="v-card-img"
            style="display:flex; flex-direction: column; align-items:center; justify-content:center; color: var(--text-secondary); background: var(--bg-color);">
            {% if item.media_type == 'VIDEO' %}
            <div style="font-size: 32px;"><i class="fas fa-play-circle"></i></div>
            {% elif item.media_type == 'DOCUMENT' %}
            <div style="font-size: 32px;"><i class="fas fa-file-pdf"></i></div>
            {% else %}
            <div style="font-size: 32px;"><i class="fas fa-file"></i></div>
            {% endif %}
            <div
                style="font-size: 10px; font-weight: 800; margin-top: 10px; text-transform: uppercase; letter-spacing: 1px;">
                {{ item.media_type }}</div>
        </div>
        {% endif %}
    </a>

    <div class="v-card-body">
        <a href="{% url 'media-detail-page' item.id %}" class="v-card-title">{{ item.title }}</a>

        <div class="v-card-footer">
            <a href="{% url 'user_profile' item.uploader.username %}" class="v-uploader-info">
                {% if item.uploader.profile_picture %}
                <img src="{{ item.uploader.profile_picture.url }}" class="v-mini-avatar"
                    alt="{{ item.uploader.username }}">
                {% else %}
                <div class="v-mini-avatar">{{ item.uploader.username|first|upper }}</div>
                {% endif %}
                <span>{{ item.uploader.username }}</span>
            </a>

            <div class="v-card-stats">
                <i class="far fa-eye" style="font-size: 11px; margin-right: 4px;"></i>
                <span>{{ item.views_count }} views</span>
            </div>
        </div>
    </div>

    <!-- More Options Menu -->
    {% if user.is_authenticated and item.uploader == user or user.is_superuser %}
    <div class="media-card-menu-btn"
        onclick="event.preventDefault(); event.stopPropagation(); toggleCardMenu(this, '{{ item.id }}')">
        <i class="fas fa-ellipsis-v"></i>
    </div>
    <!-- Dropdown -->
    <div id="card-menu-{{ item.id }}" class="media-card-dropdown" onclick="event.stopPropagation();">
        <a href="{% url 'media-edit' item.id %}"><i class="fas fa-pen-to-square"></i> Rename / Edit</a>

        {% if item.is_hidden %}
        <a href="{% url 'media-visibility' item.id 'unhide' %}"><i class="fas fa-eye"></i> Unhide</a>
        {% else %}
        <a href="{% url 'media-visibility' item.id 'hide' %}"><i class="fas fa-eye-slash"></i> Hide</a>
        {% endif %}

        {% if item.is_private %}
        <a href="{% url 'media-visibility' item.id 'public' %}"><i class="fas fa-globe"></i> Make Public</a>
        {% else %}
        <a href="{% url 'media-visibility' item.id 'private' %}"><i class="fas fa-lock"></i> Make Private</a>
        {% endif %}

        {% if item.media_type == 'IMAGE' and item.folder %}
        <a href="{% url 'set-folder-cover' item.folder.id item.id %}"><i class="fas fa-image"></i> Set as Cover</a>
        {% endif %}

        <hr style="border: none; border-top: 1px solid var(--border-color); margin: 4px 0;">
        <form action="{% url 'media-delete' item.id %}" method="POST"
            onsubmit="return confirm('Are you sure you want to delete this item?')">
            {% csrf_token %}
            <button type="submit"
                style="color: var(--danger); width: 100%; text-align: left; background: none; border: none; padding: 12px; cursor: pointer; font-family: inherit; font-size: 14px; display: flex; align-items: center; gap: 10px; border-radius: 8px;">
                <i class="fas fa-trash-can"></i> Delete
            </button>
        </form>
    </div>
    {% endif %}
</div>