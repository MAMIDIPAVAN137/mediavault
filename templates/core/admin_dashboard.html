{% extends "base.html" %}

{% block content %}
<div class="v-container-full">
    <div class="v-section">
        <div class="v-section-header">
            <h1 class="v-section-title">Admin Dashboard</h1>
            <p style="color: var(--text-secondary); margin: 0;">System overview and administrative controls.</p>
        </div>

        <div class="v-admin-grid">
            <!-- Pending Requests -->
            <a href="{% url 'admin_upload_requests' %}" class="v-admin-card"
                style="border-left: 4px solid var(--accent-color);">
                <div class="v-admin-card-header">
                    <div class="v-admin-icon" style="background: rgba(91, 95, 199, 0.1); color: var(--accent-color);">
                        <i class="fas fa-envelope-open-text"></i>
                    </div>
                    <span
                        style="font-size: 11px; font-weight: 800; color: var(--accent-color); text-transform: uppercase; letter-spacing: 1px;">Action
                        Required</span>
                </div>
                <div class="v-stat-value" style="font-size: 32px; margin-bottom: 4px;">{{ pending_requests_count }}
                </div>
                <div style="font-size: 14px; font-weight: 600; color: var(--text-primary);">Pending Requests</div>
                <div style="font-size: 12px; color: var(--text-secondary); margin-top: 8px;">Upload permissions awaiting
                    review</div>
            </a>

            <!-- Total Uploaders -->
            <a href="{% url 'admin_user_list' %}?filter=uploaders" class="v-admin-card"
                style="border-left: 4px solid var(--accent-color);">
                <div class="v-admin-card-header">
                    <div class="v-admin-icon" style="background: rgba(91, 95, 199, 0.1); color: var(--accent-color);">
                        <i class="fas fa-cloud-arrow-up"></i>
                    </div>
                </div>
                <div class="v-stat-value" style="font-size: 32px; margin-bottom: 4px;">{{ uploader_count }}</div>
                <div style="font-size: 14px; font-weight: 600; color: var(--text-primary);">Total Uploaders</div>
                <div style="font-size: 12px; color: var(--text-secondary); margin-top: 8px;">Active content contributors
                </div>
            </a>

            <!-- Total Users -->
            <a href="{% url 'admin_user_list' %}" class="v-admin-card" style="border-left: 4px solid var(--success);">
                <div class="v-admin-card-header">
                    <div class="v-admin-icon" style="background: rgba(16, 124, 16, 0.1); color: var(--success);">
                        <i class="fas fa-users"></i>
                    </div>
                </div>
                <div class="v-stat-value" style="font-size: 32px; margin-bottom: 4px;">{{ user_count }}</div>
                <div style="font-size: 14px; font-weight: 600; color: var(--text-primary);">System Users</div>
                <div style="font-size: 12px; color: var(--text-secondary); margin-top: 8px;">Total registered accounts
                </div>
            </a>

            <!-- Media Items -->
            <a href="{% url 'admin_media_list' %}" class="v-admin-card" style="border-left: 4px solid var(--danger);">
                <div class="v-admin-card-header">
                    <div class="v-admin-icon" style="background: rgba(209, 52, 56, 0.1); color: var(--danger);">
                        <i class="fas fa-photo-film"></i>
                    </div>
                </div>
                <div class="v-stat-value" style="font-size: 32px; margin-bottom: 4px;">{{ media_count }}</div>
                <div style="font-size: 14px; font-weight: 600; color: var(--text-primary);">Media Assets</div>
                <div style="font-size: 12px; color: var(--text-secondary); margin-top: 8px;">Files and shared content
                </div>
            </a>

            <!-- Support Tickets -->
            <a href="{% url 'admin_upload_requests' %}" class="v-admin-card" style="border-left: 4px solid #F6AD55;">
                <div class="v-admin-card-header">
                    <div class="v-admin-icon" style="background: rgba(246, 173, 85, 0.1); color: #F6AD55;">
                        <i class="fas fa-triangle-exclamation"></i>
                    </div>
                </div>
                <div class="v-stat-value" style="font-size: 32px; margin-bottom: 4px;">{{ reported_problems_count }}
                </div>
                <div style="font-size: 14px; font-weight: 600; color: var(--text-primary);">Active Reports</div>
                <div style="font-size: 12px; color: var(--text-secondary); margin-top: 8px;">User issues and bug reports
                </div>
            </a>
        </div>

        <div class="v-section" style="margin-top: 48px;">
            <div class="v-section-header">
                <h3 class="v-section-title" style="font-size: 20px; color: #F6AD55;">Recent Problems</h3>
                <a href="{% url 'admin_upload_requests' %}" class="v-btn v-btn-secondary">Manage All</a>
            </div>

            <div
                style="background: var(--card-bg); border-radius: var(--card-radius); border: 1.5px solid var(--border-color); overflow: hidden;">
                {% for p in recent_problems %}
                <div
                    style="padding: 16px 24px; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center;">
                    <div style="display: flex; gap: 12px; align-items: center;">
                        <span style="font-size: 20px; color: #F6AD55;"><i class="fas fa-circle-exclamation"></i></span>
                        <div>
                            <p style="margin: 0; font-weight: 700; font-size: 14px;">{{ p.user.username }}</p>
                            <p style="margin: 0; font-size: 13px; color: var(--text-secondary); line-height: 1.4;">{{
                                p.message|truncatechars:100 }}</p>
                        </div>
                    </div>
                    <span style="font-size: 11px; color: var(--text-secondary); white-space: nowrap;">{{
                        p.created_at|timesince }} ago</span>
                </div>
                {% empty %}
                <p style="text-align: center; padding: 40px; color: var(--text-secondary);">No active problems reported.
                </p>
                {% endfor %}
            </div>
        </div>

        <div class="v-section" style="margin-top: 48px;">
            <div class="v-section-header">
                <h3 class="v-section-title" style="font-size: 20px;">Recent Activity</h3>
                <a href="{% url 'home' %}" class="v-btn v-btn-secondary">View All</a>
            </div>

            <div class="v-grid">
                {% for item in recent_uploads %}
                {% include "media/media_card.html" %}
                {% empty %}
                <p style="grid-column: 1/-1; text-align: center; padding: 40px; color: var(--text-secondary);">No recent
                    uploads.</p>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}